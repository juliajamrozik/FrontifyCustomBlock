{"version":3,"file":"Popper.es.js","sources":["../../../src/components/Popper/Popper.tsx"],"sourcesContent":["/* (c) Copyright Frontify Ltd., all rights reserved. */\n\nimport React, {\n    Children,\n    ReactElement,\n    ReactNode,\n    createContext,\n    isValidElement,\n    useContext,\n    useEffect,\n    useMemo,\n    useState,\n} from 'react';\nimport { usePopper } from 'react-popper';\nimport { Portal } from '@components/Portal';\nimport { PopperProps } from '@components/Popper/types';\n\nconst PopperContext = createContext<PopperProps>({});\n\nconst Reference = ({ children }: { children: ReactElement }) => {\n    return children;\n};\nReference.displayName = 'FonduePopperReference';\n\nconst Content = ({ children }: { children?: ReactNode }): Nullable<ReactElement> => {\n    const { open } = usePopperContext();\n    // eslint-disable-next-line react/jsx-no-useless-fragment\n    return open ? <>{children}</> : null;\n};\nContent.displayName = 'FonduePopperContent';\n\nconst usePopperContext = () => {\n    const context = useContext(PopperContext);\n    if (!context) {\n        throw new Error('Popper compound components cannot be rendered outside the Popper component');\n    }\n    return context;\n};\n\nexport const Popper = ({\n    children,\n    open,\n    placement = 'bottom-start',\n    offset = [0, 8],\n    flip = true,\n    enablePortal = true,\n    zIndex = 'auto',\n}: PopperProps) => {\n    const [referenceElement, setReferenceElement] = useState<HTMLDivElement | null>(null);\n    const [popperElement, setPopperElement] = useState<HTMLElement | null>(null);\n\n    const popperInstance = usePopper(referenceElement, popperElement, {\n        placement,\n        modifiers: [\n            { name: 'offset', options: { offset } },\n            {\n                name: 'flip',\n                enabled: flip,\n            },\n        ],\n    });\n\n    useEffect(() => {\n        const updatePopper = async () => {\n            if (popperInstance.update) {\n                await popperInstance.update();\n            }\n        };\n\n        updatePopper().catch(console.error);\n    }, [flip, placement, offset, open]);\n\n    const value = useMemo(() => ({ open }), [open]);\n    return (\n        <PopperContext.Provider value={value}>\n            {Children.map(children, (child) => {\n                if (isValidElement(child) && typeof child.type === 'function') {\n                    const { name } = child.type;\n\n                    if (name === Reference.name) {\n                        return <div ref={setReferenceElement}>{child}</div>;\n                    }\n\n                    if (name === Content.name) {\n                        return enablePortal ? (\n                            <Portal>\n                                <div\n                                    ref={setPopperElement}\n                                    style={{ zIndex, ...popperInstance.styles.popper }}\n                                    {...popperInstance.attributes.popper}\n                                >\n                                    {child}\n                                </div>\n                            </Portal>\n                        ) : (\n                            <div\n                                ref={setPopperElement}\n                                style={{ zIndex, ...popperInstance.styles.popper }}\n                                {...popperInstance.attributes.popper}\n                            >\n                                {child}\n                            </div>\n                        );\n                    }\n                }\n            })}\n        </PopperContext.Provider>\n    );\n};\nPopper.displayName = 'FonduePopper';\nPopper.Reference = Reference;\nPopper.Content = Content;\n"],"names":["PopperContext","createContext","Reference","children","Content","open","usePopperContext","React","context","useContext","Popper","placement","offset","flip","enablePortal","zIndex","referenceElement","setReferenceElement","useState","popperElement","setPopperElement","popperInstance","usePopper","useEffect","value","useMemo","Children","child","isValidElement","name","Portal"],"mappings":";;;AAiBA,MAAMA,IAAgBC,EAA2B,CAAA,CAAE,GAE7CC,IAAY,CAAC,EAAE,UAAAC,QACVA;AAEXD,EAAU,cAAc;AAExB,MAAME,IAAU,CAAC,EAAE,UAAAD,QAAiE;AAC1E,QAAA,EAAE,MAAAE,MAASC;AAEV,SAAAD,IAAU,gBAAAE,EAAA,cAAAA,EAAA,UAAA,MAAAJ,CAAS,IAAM;AACpC;AACAC,EAAQ,cAAc;AAEtB,MAAME,IAAmB,MAAM;AACrB,QAAAE,IAAUC,EAAWT,CAAa;AACxC,MAAI,CAACQ;AACK,UAAA,IAAI,MAAM,4EAA4E;AAEzF,SAAAA;AACX,GAEaE,IAAS,CAAC;AAAA,EACnB,UAAAP;AAAA,EACA,MAAAE;AAAA,EACA,WAAAM,IAAY;AAAA,EACZ,QAAAC,IAAS,CAAC,GAAG,CAAC;AAAA,EACd,MAAAC,IAAO;AAAA,EACP,cAAAC,IAAe;AAAA,EACf,QAAAC,IAAS;AACb,MAAmB;AACf,QAAM,CAACC,GAAkBC,CAAmB,IAAIC,EAAgC,IAAI,GAC9E,CAACC,GAAeC,CAAgB,IAAIF,EAA6B,IAAI,GAErEG,IAAiBC,EAAUN,GAAkBG,GAAe;AAAA,IAC9D,WAAAR;AAAA,IACA,WAAW;AAAA,MACP,EAAE,MAAM,UAAU,SAAS,EAAE,QAAAC,IAAS;AAAA,MACtC;AAAA,QACI,MAAM;AAAA,QACN,SAASC;AAAA,MACb;AAAA,IACJ;AAAA,EAAA,CACH;AAED,EAAAU,EAAU,MAAM;AAOC,KANQ,YAAY;AAC7B,MAAIF,EAAe,UACf,MAAMA,EAAe;IACzB,KAGW,MAAM,QAAQ,KAAK;AAAA,KACnC,CAACR,GAAMF,GAAWC,GAAQP,CAAI,CAAC;AAE5B,QAAAmB,IAAQC,EAAQ,OAAO,EAAE,MAAApB,MAAS,CAACA,CAAI,CAAC;AAE1C,SAAA,gBAAAE,EAAA,cAACP,EAAc,UAAd,EAAuB,OAAAwB,KACnBE,EAAS,IAAIvB,GAAU,CAACwB,MAAU;AAC/B,QAAIC,EAAeD,CAAK,KAAK,OAAOA,EAAM,QAAS,YAAY;AACrD,YAAA,EAAE,MAAAE,EAAK,IAAIF,EAAM;AAEnB,UAAAE,MAAS3B,EAAU;AACnB,eAAQ,gBAAAK,EAAA,cAAA,OAAA,EAAI,KAAKU,EAAA,GAAsBU,CAAM;AAG7C,UAAAE,MAASzB,EAAQ;AACV,eAAAU,oCACFgB,GACG,MAAA,gBAAAvB,EAAA;AAAA,UAAC;AAAA,UAAA;AAAA,YACG,KAAKa;AAAA,YACL,OAAO,EAAE,QAAAL,GAAQ,GAAGM,EAAe,OAAO,OAAO;AAAA,YAChD,GAAGA,EAAe,WAAW;AAAA,UAAA;AAAA,UAE7BM;AAAA,QAAA,CAET,IAEA,gBAAApB,EAAA;AAAA,UAAC;AAAA,UAAA;AAAA,YACG,KAAKa;AAAA,YACL,OAAO,EAAE,QAAAL,GAAQ,GAAGM,EAAe,OAAO,OAAO;AAAA,YAChD,GAAGA,EAAe,WAAW;AAAA,UAAA;AAAA,UAE7BM;AAAA,QAAA;AAAA,IAIjB;AAAA,EACH,CAAA,CACL;AAER;AACAjB,EAAO,cAAc;AACrBA,EAAO,YAAYR;AACnBQ,EAAO,UAAUN;"}