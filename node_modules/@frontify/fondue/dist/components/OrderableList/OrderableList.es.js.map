{"version":3,"file":"OrderableList.es.js","sources":["../../../src/components/OrderableList/OrderableList.tsx"],"sourcesContent":["/* (c) Copyright Frontify Ltd., all rights reserved. */\n\nimport React, { useEffect, useState } from 'react';\n\nimport { CollectionItem } from './CollectionItem';\nimport { OrderableListItem, OrderableListProps } from './types';\nimport { DropZone } from '@components/DropZone';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport { DndProvider } from 'react-dnd';\nimport { moveItems } from '@utilities/dnd';\nimport { useId } from '@react-aria/utils';\nimport { CollisionPosition } from '..';\n\nconst listItemsCompareFn = <T extends object>(itemA: OrderableListItem<T>, itemB: OrderableListItem<T>): number => {\n    if (itemA.sort === null && itemB.sort === null) {\n        return 1;\n    }\n    if (itemA.sort === null) {\n        return 1;\n    }\n    if (itemB.sort === null) {\n        return -1;\n    }\n\n    return itemA.sort - itemB.sort;\n};\n\nexport const OrderableList = <T extends object>({\n    onMove,\n    dragDisabled,\n    items,\n    renderContent,\n    'data-test-id': dataTestId = 'orderable-list',\n}: OrderableListProps<T>) => {\n    const [itemsState, setItemsState] = useState(items);\n    const listId = useId();\n\n    useEffect(() => {\n        // sort the incoming items\n        const itemsClone = [...items];\n        itemsClone.sort(listItemsCompareFn);\n        setItemsState(itemsClone);\n    }, [items]);\n\n    const handleDrop = (\n        targetItem: OrderableListItem<T>,\n        sourceItem: OrderableListItem<T>,\n        position: CollisionPosition,\n    ) => {\n        const modifiedItems = moveItems(targetItem, sourceItem, position, itemsState);\n        onMove(modifiedItems);\n    };\n\n    return (\n        <DndProvider backend={HTML5Backend}>\n            <div className=\"tw-outline-none\" data-test-id={dataTestId}>\n                {itemsState.map((item, index) => (\n                    <React.Fragment key={`dropzone-orderable-list-key-${index}`}>\n                        <DropZone\n                            key={`orderable-list-item-${index}-before`}\n                            data={{\n                                targetItem: item,\n                                position: 'before' as const,\n                            }}\n                            onDrop={handleDrop}\n                            accept={listId}\n                        />\n                        <CollectionItem\n                            key={item.id}\n                            dragDisabled={dragDisabled}\n                            item={item}\n                            renderContent={renderContent}\n                            listId={listId}\n                        />\n                        {index === items.length - 1 && (\n                            <DropZone\n                                key={`orderable-list-item-${index}-after`}\n                                data={{\n                                    targetItem: item,\n                                    position: 'after' as const,\n                                }}\n                                onDrop={handleDrop}\n                                accept={listId}\n                            />\n                        )}\n                    </React.Fragment>\n                ))}\n            </div>\n        </DndProvider>\n    );\n};\nOrderableList.displayName = 'FondueOrderableList';\n"],"names":["listItemsCompareFn","itemA","itemB","OrderableList","onMove","dragDisabled","items","renderContent","dataTestId","itemsState","setItemsState","useState","listId","useId","useEffect","itemsClone","handleDrop","targetItem","sourceItem","position","modifiedItems","moveItems","React","DndProvider","HTML5Backend","item","index","DropZone","CollectionItem"],"mappings":";;;;;;;AAaA,MAAMA,IAAqB,CAAmBC,GAA6BC,MACnED,EAAM,SAAS,QAAQC,EAAM,SAAS,QAGtCD,EAAM,SAAS,OACR,IAEPC,EAAM,SAAS,OACR,KAGJD,EAAM,OAAOC,EAAM,MAGjBC,IAAgB,CAAmB;AAAA,EAC5C,QAAAC;AAAA,EACA,cAAAC;AAAA,EACA,OAAAC;AAAA,EACA,eAAAC;AAAA,EACA,gBAAgBC,IAAa;AACjC,MAA6B;AACzB,QAAM,CAACC,GAAYC,CAAa,IAAIC,EAASL,CAAK,GAC5CM,IAASC;AAEf,EAAAC,EAAU,MAAM;AAEN,UAAAC,IAAa,CAAC,GAAGT,CAAK;AAC5B,IAAAS,EAAW,KAAKf,CAAkB,GAClCU,EAAcK,CAAU;AAAA,EAAA,GACzB,CAACT,CAAK,CAAC;AAEV,QAAMU,IAAa,CACfC,GACAC,GACAC,MACC;AACD,UAAMC,IAAgBC,EAAUJ,GAAYC,GAAYC,GAAUV,CAAU;AAC5E,IAAAL,EAAOgB,CAAa;AAAA,EAAA;AAIpB,SAAA,gBAAAE,EAAA,cAACC,KAAY,SAASC,EAAA,mCACjB,OAAI,EAAA,WAAU,mBAAkB,gBAAchB,EAAA,GAC1CC,EAAW,IAAI,CAACgB,GAAMC,MACnB,gBAAAJ,EAAA,cAACA,EAAM,UAAN,EAAe,KAAK,+BAA+BI,IAChD,GAAA,gBAAAJ,EAAA;AAAA,IAACK;AAAA,IAAA;AAAA,MACG,KAAK,uBAAuBD;AAAA,MAC5B,MAAM;AAAA,QACF,YAAYD;AAAA,QACZ,UAAU;AAAA,MACd;AAAA,MACA,QAAQT;AAAA,MACR,QAAQJ;AAAA,IAAA;AAAA,EAEZ,GAAA,gBAAAU,EAAA;AAAA,IAACM;AAAA,IAAA;AAAA,MACG,KAAKH,EAAK;AAAA,MACV,cAAApB;AAAA,MACA,MAAAoB;AAAA,MACA,eAAAlB;AAAA,MACA,QAAAK;AAAA,IAAA;AAAA,EAEH,GAAAc,MAAUpB,EAAM,SAAS,KACtB,gBAAAgB,EAAA;AAAA,IAACK;AAAA,IAAA;AAAA,MACG,KAAK,uBAAuBD;AAAA,MAC5B,MAAM;AAAA,QACF,YAAYD;AAAA,QACZ,UAAU;AAAA,MACd;AAAA,MACA,QAAQT;AAAA,MACR,QAAQJ;AAAA,IAAA;AAAA,EAAA,CAGpB,CACH,CACL,CACJ;AAER;AACAT,EAAc,cAAc;"}