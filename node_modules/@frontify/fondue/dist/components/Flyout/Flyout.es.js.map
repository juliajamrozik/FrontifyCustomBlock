{"version":3,"file":"Flyout.es.js","sources":["../../../src/components/Flyout/Flyout.tsx"],"sourcesContent":["/* (c) Copyright Frontify Ltd., all rights reserved. */\n\nimport { BadgeProps } from '@components/Badge';\nimport { watchModals } from '@react-aria/aria-modal-polyfill';\nimport { useButton } from '@react-aria/button';\nimport { FocusScope, useFocusRing } from '@react-aria/focus';\nimport { OverlayContainer, useOverlayTrigger } from '@react-aria/overlays';\nimport { mergeProps } from '@react-aria/utils';\nimport { useOverlayTriggerState } from '@react-stately/overlays';\nimport { FOCUS_STYLE } from '@utilities/focusStyle';\nimport { merge } from '@utilities/merge';\nimport React, { HTMLAttributes, MouseEvent, MutableRefObject, ReactElement, ReactNode, useEffect, useRef } from 'react';\nimport { LegacyFlyoutFooter } from '.';\nimport { useContainScroll } from './hooks/useContainScroll';\nimport { useOverlayPositionWithBottomMargin } from './hooks/useOverlayPositionWithBottomMargin';\nimport { Overlay } from './Overlay';\n\nexport const FLYOUT_DIVIDER_COLOR = '#eaebeb';\nexport const FLYOUT_DIVIDER_HEIGHT = '10px';\n\nexport enum FlyoutPlacement {\n    Top = 'top',\n    Bottom = 'bottom',\n    TopLeft = 'top left',\n    BottomLeft = 'bottom left',\n    TopRight = 'top right',\n    BottomRight = 'bottom right',\n    Right = 'right',\n    Left = 'left',\n}\n\nexport type FlyoutProps = {\n    trigger:\n        | ReactNode\n        | ((\n              triggerProps: HTMLAttributes<HTMLElement>,\n              ref: MutableRefObject<HTMLElement | null>,\n              triggerState: { isFocusVisible: boolean; isPressed: boolean },\n          ) => JSX.Element);\n    onCancel?: () => void;\n    onConfirm?: (event?: MouseEvent<HTMLButtonElement>) => void;\n    title?: string;\n    decorator?: ReactNode;\n    badges?: BadgeProps[];\n    hug?: boolean;\n    fitContent?: boolean;\n    isOpen?: boolean;\n    onOpenChange: (isOpen: boolean) => void;\n    fixedHeader?: ReactNode;\n    fixedFooter?: ReactNode;\n    contentMinHeight?: number;\n    /**\n     * The legacy footer buttons section inside of the flyout will be deleted in the future.\n     * @deprecated Pass the FlyoutFooter component with buttons to the Flyout component.\n     */\n    legacyFooter?: boolean;\n    placement?: FlyoutPlacement;\n    offset?: number;\n    updatePositionOnContentChange?: boolean;\n    isTriggerDisabled?: boolean;\n    children?: ReactNode;\n};\n\nexport const Flyout = ({\n    trigger,\n    isTriggerDisabled = false,\n    decorator,\n    onConfirm,\n    onCancel,\n    children,\n    onOpenChange,\n    isOpen = false,\n    title = '',\n    badges = [],\n    hug = true,\n    fitContent = false,\n    fixedHeader,\n    fixedFooter,\n    contentMinHeight,\n    legacyFooter = true,\n    placement = FlyoutPlacement.BottomLeft,\n    offset,\n    updatePositionOnContentChange = false,\n}: FlyoutProps): ReactElement => {\n    const state = useOverlayTriggerState({ isOpen, onOpenChange });\n    const { toggle, close } = state;\n    const triggerRef = useRef<HTMLDivElement | null>(null);\n    const overlayRef = useRef<HTMLDivElement | null>(null);\n    const scrollRef = useRef<HTMLDivElement | null>(null);\n    const { isFocusVisible, focusProps } = useFocusRing();\n\n    const { triggerProps, overlayProps: overlayTriggerProps } = useOverlayTrigger(\n        { type: 'dialog' },\n        state,\n        triggerRef,\n    );\n\n    const { positionProps } = useOverlayPositionWithBottomMargin({\n        triggerRef,\n        overlayRef,\n        scrollRef,\n        isOpen,\n        placement,\n        offset,\n        updatePositionOnContentChange,\n    });\n\n    const { buttonProps, isPressed } = useButton(\n        { onPress: () => toggle(), elementType: 'div', isDisabled: isTriggerDisabled },\n        triggerRef,\n    );\n\n    useEffect(() => {\n        const revert = watchModals();\n\n        return () => revert();\n    }, []);\n\n    useContainScroll(overlayRef, { isDisabled: !isOpen });\n\n    const combinedTriggerProps = mergeProps(buttonProps, triggerProps, focusProps, {\n        'aria-label': 'Toggle Flyout Menu',\n    });\n\n    const triggerComponent =\n        typeof trigger === 'function' ? (\n            trigger(combinedTriggerProps, triggerRef, { isFocusVisible, isPressed })\n        ) : (\n            <div\n                {...combinedTriggerProps}\n                ref={triggerRef}\n                className={merge([\n                    'tw-outline-none tw-rounded',\n                    hug ? 'tw-mx-3' : 'tw-w-full',\n                    isFocusVisible && FOCUS_STYLE,\n                ])}\n                data-test-id=\"flyout-trigger\"\n            >\n                {trigger}\n            </div>\n        );\n\n    return (\n        <>\n            {triggerComponent}\n            {isOpen && (\n                <OverlayContainer>\n                    <FocusScope restoreFocus contain>\n                        <Overlay\n                            title={title}\n                            badges={badges}\n                            decorator={decorator}\n                            isOpen={isOpen}\n                            onClose={close}\n                            overlayTriggerProps={overlayTriggerProps}\n                            positionProps={positionProps}\n                            fixedHeader={fixedHeader}\n                            fixedFooter={\n                                legacyFooter ? (\n                                    <LegacyFlyoutFooter onConfirm={onConfirm} onCancel={onCancel} />\n                                ) : (\n                                    fixedFooter\n                                )\n                            }\n                            ref={overlayRef}\n                            scrollRef={scrollRef}\n                            fitContent={fitContent}\n                            contentMinHeight={contentMinHeight}\n                        >\n                            {children}\n                        </Overlay>\n                    </FocusScope>\n                </OverlayContainer>\n            )}\n        </>\n    );\n};\nFlyout.displayName = 'FondueFlyout';\n"],"names":["FLYOUT_DIVIDER_COLOR","FLYOUT_DIVIDER_HEIGHT","FlyoutPlacement","Flyout","trigger","isTriggerDisabled","decorator","onConfirm","onCancel","children","onOpenChange","isOpen","title","badges","hug","fitContent","fixedHeader","fixedFooter","contentMinHeight","legacyFooter","placement","offset","updatePositionOnContentChange","state","useOverlayTriggerState","toggle","close","triggerRef","useRef","overlayRef","scrollRef","isFocusVisible","focusProps","useFocusRing","triggerProps","overlayTriggerProps","useOverlayTrigger","positionProps","useOverlayPositionWithBottomMargin","buttonProps","isPressed","useButton","useEffect","revert","watchModals","useContainScroll","combinedTriggerProps","mergeProps","triggerComponent","React","merge","FOCUS_STYLE","OverlayContainer","FocusScope","Overlay","LegacyFlyoutFooter"],"mappings":"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"}