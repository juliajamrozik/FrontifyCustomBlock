{"version":3,"file":"useMenuKeyboardNavigation.es.js","sources":["../../../src/components/Menu/useMenuKeyboardNavigation.ts"],"sourcesContent":["/* (c) Copyright Frontify Ltd., all rights reserved. */\n\nimport { useCallback, useEffect, useState } from 'react';\n\nexport const useMenuKeyboardNavigation = (\n    isMenuOpened: boolean,\n    menuContainerRef: HTMLElement | null,\n    focusableElementsSelector = 'li > button:not(:disabled)',\n) => {\n    const [currentItemIndex, setCurrentItemIndex] = useState(0);\n    const [itemsElements, setItemsElements] = useState<NodeList>();\n    const [menuKeyboardNavigationAction, setMenuKeyboardNavigationAction] = useState('');\n\n    const handleKeyDown = useCallback(\n        (event: KeyboardEvent) => {\n            if (!itemsElements || !['Tab', 'ArrowDown', 'ArrowUp', 'Escape'].includes(event.key)) {\n                return;\n            }\n\n            const isTab = event.key === 'Tab' && !event.shiftKey;\n            const isShiftTab = event.key === 'Tab' && event.shiftKey;\n            const isEsc = event.key === 'Escape';\n            const shouldMoveDown = isTab || event.key === 'ArrowDown';\n            const shouldMoveUp = isShiftTab || event.key === 'ArrowUp';\n\n            if (\n                (isShiftTab && currentItemIndex <= 0) ||\n                (isTab && currentItemIndex >= itemsElements.length - 1) ||\n                isEsc\n            ) {\n                setMenuKeyboardNavigationAction('CLOSE_MENU');\n                return;\n            }\n\n            if (shouldMoveDown) {\n                setCurrentItemIndex(Math.min(currentItemIndex + 1, itemsElements.length - 1));\n            } else if (shouldMoveUp) {\n                setCurrentItemIndex(Math.max(currentItemIndex - 1, 0));\n            }\n\n            event.preventDefault();\n        },\n        [itemsElements, currentItemIndex],\n    );\n\n    useEffect(() => {\n        if (!isMenuOpened || !menuContainerRef) {\n            return;\n        }\n\n        const focusableItems = menuContainerRef.querySelectorAll(focusableElementsSelector);\n        for (const item of focusableItems) {\n            (item as HTMLButtonElement | HTMLAnchorElement).onkeydown = handleKeyDown;\n        }\n\n        if (!itemsElements && focusableItems.length > 0) {\n            setItemsElements(focusableItems);\n        }\n    }, [isMenuOpened, menuContainerRef, itemsElements, handleKeyDown, focusableElementsSelector]);\n\n    useEffect(() => {\n        if (!itemsElements) {\n            return;\n        }\n\n        if (itemsElements[currentItemIndex]) {\n            (itemsElements[currentItemIndex] as HTMLButtonElement | HTMLAnchorElement).focus();\n        }\n    }, [currentItemIndex, itemsElements]);\n\n    useEffect(() => {\n        if (!isMenuOpened) {\n            setItemsElements(undefined);\n            setMenuKeyboardNavigationAction('');\n        }\n\n        setCurrentItemIndex(0);\n    }, [isMenuOpened]);\n\n    return menuKeyboardNavigationAction;\n};\n"],"names":["useMenuKeyboardNavigation","isMenuOpened","menuContainerRef","focusableElementsSelector","currentItemIndex","setCurrentItemIndex","useState","itemsElements","setItemsElements","menuKeyboardNavigationAction","setMenuKeyboardNavigationAction","handleKeyDown","useCallback","event","isTab","isShiftTab","isEsc","shouldMoveDown","shouldMoveUp","useEffect","focusableItems","item"],"mappings":";AAIO,MAAMA,IAA4B,CACrCC,GACAC,GACAC,IAA4B,iCAC3B;AACD,QAAM,CAACC,GAAkBC,CAAmB,IAAIC,EAAS,CAAC,GACpD,CAACC,GAAeC,CAAgB,IAAIF,EAAmB,GACvD,CAACG,GAA8BC,CAA+B,IAAIJ,EAAS,EAAE,GAE7EK,IAAgBC;AAAA,IAClB,CAACC,MAAyB;AACtB,UAAI,CAACN,KAAiB,CAAC,CAAC,OAAO,aAAa,WAAW,QAAQ,EAAE,SAASM,EAAM,GAAG;AAC/E;AAGJ,YAAMC,IAAQD,EAAM,QAAQ,SAAS,CAACA,EAAM,UACtCE,IAAaF,EAAM,QAAQ,SAASA,EAAM,UAC1CG,IAAQH,EAAM,QAAQ,UACtBI,IAAiBH,KAASD,EAAM,QAAQ,aACxCK,IAAeH,KAAcF,EAAM,QAAQ;AAG5C,UAAAE,KAAcX,KAAoB,KAClCU,KAASV,KAAoBG,EAAc,SAAS,KACrDS,GACF;AACE,QAAAN,EAAgC,YAAY;AAC5C;AAAA,MACJ;AAEA,MAAIO,IACAZ,EAAoB,KAAK,IAAID,IAAmB,GAAGG,EAAc,SAAS,CAAC,CAAC,IACrEW,KACPb,EAAoB,KAAK,IAAID,IAAmB,GAAG,CAAC,CAAC,GAGzDS,EAAM,eAAe;AAAA,IACzB;AAAA,IACA,CAACN,GAAeH,CAAgB;AAAA,EAAA;AAGpC,SAAAe,EAAU,MAAM;AACR,QAAA,CAAClB,KAAgB,CAACC;AAClB;AAGE,UAAAkB,IAAiBlB,EAAiB,iBAAiBC,CAAyB;AAClF,eAAWkB,KAAQD;AACd,MAAAC,EAA+C,YAAYV;AAGhE,IAAI,CAACJ,KAAiBa,EAAe,SAAS,KAC1CZ,EAAiBY,CAAc;AAAA,EACnC,GACD,CAACnB,GAAcC,GAAkBK,GAAeI,GAAeR,CAAyB,CAAC,GAE5FgB,EAAU,MAAM;AACZ,IAAKZ,KAIDA,EAAcH,CAAgB,KAC7BG,EAAcH,CAAgB,EAA4C;EAC/E,GACD,CAACA,GAAkBG,CAAa,CAAC,GAEpCY,EAAU,MAAM;AACZ,IAAKlB,MACDO,EAAiB,MAAS,GAC1BE,EAAgC,EAAE,IAGtCL,EAAoB,CAAC;AAAA,EAAA,GACtB,CAACJ,CAAY,CAAC,GAEVQ;AACX;"}