{"version":3,"file":"index.es.js","sources":["../../../../../../../../src/components/RichTextEditor/serializer/markdown/remarkFondue/extensions/link/index.ts"],"sourcesContent":["/* (c) Copyright Frontify Ltd., all rights reserved. */\n\nimport { VisitorResult, visit } from 'unist-util-visit';\nimport { TargetValue, Targets } from '../../../types';\nimport { NodeChild, RemarkExtension, TreeNode } from '../../types';\n\nexport default function Extension(): RemarkExtension {\n    return transformer;\n}\n\nconst transformer = (tree: TreeNode) => {\n    visit(tree, 'link', visitor);\n\n    function visitor(node: TreeNode, index: number, parent: TreeNode): VisitorResult {\n        const child = parent.children[index + 1];\n        updateLinkNodeWithTarget(node, child);\n    }\n};\n\nconst targetValueRegex = new RegExp(`{:target=\"(${Object.values(Targets).join('|')})\"}`);\nconst getTarget = (child: NodeChild): TargetValue | undefined => {\n    const match = child.value?.match(targetValueRegex);\n\n    if (!match) {\n        return Targets.Self;\n    }\n\n    if (match[1] === Targets.Blank) {\n        return undefined;\n    }\n\n    return match[1] as TargetValue;\n};\nconst replaceChildValue = (child: NodeChild): string => child.value?.replace(targetValueRegex, '') ?? '';\n\nconst updateLinkNodeWithTarget = (node: TreeNode, child: NodeChild) => {\n    if (!child) {\n        return;\n    }\n\n    node.target = getTarget(child);\n    child.value = replaceChildValue(child);\n};\n"],"names":["Extension","transformer","tree","visit","visitor","node","index","parent","child","updateLinkNodeWithTarget","targetValueRegex","Targets","getTarget","match","_a","replaceChildValue"],"mappings":";;AAMA,SAAwBA,IAA6B;AAC1C,SAAAC;AACX;AAEA,MAAMA,IAAc,CAACC,MAAmB;AAC9B,EAAAC,EAAAD,GAAM,QAAQE,CAAO;AAElB,WAAAA,EAAQC,GAAgBC,GAAeC,GAAiC;AAC7E,UAAMC,IAAQD,EAAO,SAASD,IAAQ,CAAC;AACvC,IAAAG,EAAyBJ,GAAMG,CAAK;AAAA,EACxC;AACJ,GAEME,IAAmB,IAAI,OAAO,cAAc,OAAO,OAAOC,CAAO,EAAE,KAAK,GAAG,MAAM,GACjFC,IAAY,CAACJ,MAA8C;;AAC7D,QAAMK,KAAQC,IAAAN,EAAM,UAAN,gBAAAM,EAAa,MAAMJ;AAEjC,MAAI,CAACG;AACD,WAAOF,EAAQ;AAGnB,MAAIE,EAAM,CAAC,MAAMF,EAAQ;AAIzB,WAAOE,EAAM,CAAC;AAClB,GACME,IAAoB,CAACP,MAA6B;;AAAA,WAAAM,IAAAN,EAAM,UAAN,gBAAAM,EAAa,QAAQJ,GAAkB,QAAO;AAAA,GAEhGD,IAA2B,CAACJ,GAAgBG,MAAqB;AACnE,EAAKA,MAIAH,EAAA,SAASO,EAAUJ,CAAK,GACvBA,EAAA,QAAQO,EAAkBP,CAAK;AACzC;"}