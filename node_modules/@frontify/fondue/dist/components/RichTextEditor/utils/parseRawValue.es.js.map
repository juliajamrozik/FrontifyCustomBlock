{"version":3,"file":"parseRawValue.es.js","sources":["../../../../src/components/RichTextEditor/utils/parseRawValue.ts"],"sourcesContent":["/* (c) Copyright Frontify Ltd., all rights reserved. */\n\nimport { ELEMENT_PARAGRAPH, Value, deserializeHtml, normalizeEditor } from '@udecode/plate';\nimport { PluginComposer } from '../Plugins';\nimport { InitPlateEditor } from './InitPlateEditor';\n\nconst wrapChildrenWithoutTypeInParagraph = (children: Value): Value =>\n    children[0].hasOwnProperty('type')\n        ? children\n        : [\n              {\n                  type: 'p',\n                  children,\n              },\n          ];\n\nexport const EMPTY_RICH_TEXT_VALUE: Value = [{ type: ELEMENT_PARAGRAPH, children: [{ text: '' }] }];\n\ntype ParseRawValueOptions = {\n    editorId?: string;\n    raw?: string;\n    plugins?: PluginComposer;\n};\n\nexport const parseRawValue = ({ editorId = 'parseRawValue', raw, plugins }: ParseRawValueOptions): Value => {\n    const editor = InitPlateEditor.init(`${editorId}_parseRawValue`, plugins).getInstance();\n    let parsedValue = EMPTY_RICH_TEXT_VALUE;\n\n    if (!raw) {\n        return parsedValue;\n    }\n\n    try {\n        parsedValue = JSON.parse(raw);\n    } catch {\n        const trimmedText = raw.trim().replaceAll(/>\\s+</g, '><');\n        const parsedHtml = deserializeHtml(editor, {\n            element: trimmedText,\n        }) as Value;\n        parsedValue = wrapChildrenWithoutTypeInParagraph(parsedHtml);\n    }\n\n    editor.children = parsedValue;\n    normalizeEditor(editor, { force: true });\n\n    return editor.children;\n};\n"],"names":["wrapChildrenWithoutTypeInParagraph","children","EMPTY_RICH_TEXT_VALUE","ELEMENT_PARAGRAPH","parseRawValue","editorId","raw","plugins","editor","InitPlateEditor","parsedValue","trimmedText","parsedHtml","deserializeHtml","normalizeEditor"],"mappings":";;AAMA,MAAMA,IAAqC,CAACC,MACxCA,EAAS,CAAC,EAAE,eAAe,MAAM,IAC3BA,IACA;AAAA,EACI;AAAA,IACI,MAAM;AAAA,IACN,UAAAA;AAAA,EACJ;AACJ,GAEGC,IAA+B,CAAC,EAAE,MAAMC,GAAmB,UAAU,CAAC,EAAE,MAAM,GAAI,CAAA,GAAG,GAQrFC,IAAgB,CAAC,EAAE,UAAAC,IAAW,iBAAiB,KAAAC,GAAK,SAAAC,QAA2C;AACxG,QAAMC,IAASC,EAAgB,KAAK,GAAGJ,mBAA0BE,CAAO,EAAE;AAC1E,MAAIG,IAAcR;AAElB,MAAI,CAACI;AACM,WAAAI;AAGP,MAAA;AACc,IAAAA,IAAA,KAAK,MAAMJ,CAAG;AAAA,EAAA,QAC9B;AACE,UAAMK,IAAcL,EAAI,KAAA,EAAO,WAAW,UAAU,IAAI,GAClDM,IAAaC,EAAgBL,GAAQ;AAAA,MACvC,SAASG;AAAA,IAAA,CACZ;AACD,IAAAD,IAAcV,EAAmCY,CAAU;AAAA,EAC/D;AAEA,SAAAJ,EAAO,WAAWE,GAClBI,EAAgBN,GAAQ,EAAE,OAAO,GAAM,CAAA,GAEhCA,EAAO;AAClB;"}