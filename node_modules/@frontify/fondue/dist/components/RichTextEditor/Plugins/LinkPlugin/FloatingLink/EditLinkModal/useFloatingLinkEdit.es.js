import { useCallback as y, useEffect as F } from "react";
import { useEditorRef as h, usePlateSelectors as C, useFloatingLinkSelectors as l, getPluginOptions as R, ELEMENT_LINK as n, getAboveNode as P, getPluginType as d, getRangeBoundingClientRect as b, getStartPoint as N, getEndPoint as O, getDefaultBoundingClientRect as S, useVirtualFloatingLink as B, floatingLinkActions as o, someNode as I, floatingLinkSelectors as c, useHotkeys as v, triggerFloatingLinkEdit as x, useFloatingLinkEnter as A, useFloatingLinkEscape as D, useComposedRef as H } from "@udecode/plate";
import { getUrlFromEditor as T } from "../../utils/getUrl.es.js";
const M = ({ floatingOptions: g, ...i }) => {
  const t = h(), u = C().keyEditor(), a = l().mode(), f = l().isOpen(t.id), { triggerFloatingLinkHotkeys: m = "command+k, ctrl+k" } = R(t, n), k = y(() => {
    const e = P(t, {
      match: { type: d(t, n) }
    });
    if (e) {
      const [, s] = e;
      return b(t, {
        anchor: N(t, s),
        focus: O(t, s)
      });
    }
    return S();
  }, [t]), p = f && a === "edit", { update: r, style: E, floating: L } = B({
    editorId: t.id,
    open: p,
    getBoundingClientRect: k,
    ...g
  });
  return F(() => {
    const e = T(t);
    if (e && o.url(e), t.selection && I(t, {
      match: { type: d(t, n) }
    })) {
      o.show("edit", t.id), r();
      return;
    }
    c.mode() === "edit" && o.hide();
  }, [t, u, r]), v(
    m,
    (e) => {
      e.preventDefault(), c.mode() === "edit" && x(t);
    },
    {
      enableOnContentEditable: !0
    },
    []
  ), A(), D(), {
    style: {
      ...E,
      zIndex: 1
    },
    ...i,
    ref: H(i.ref, L)
  };
};
export {
  M as useFloatingLinkEdit
};
//# sourceMappingURL=useFloatingLinkEdit.es.js.map
