{"version":3,"file":"SelectedAsset.es.js","sources":["../../../../src/components/AssetInput/SingleAsset/SelectedAsset.tsx"],"sourcesContent":["/* (c) Copyright Frontify Ltd., all rights reserved. */\n\nimport { ActionMenu } from '@components/ActionMenu/ActionMenu/ActionMenu';\nimport { IconCaretDown } from '@foundation/Icon/Generated';\nimport { IconSize } from '@foundation/Icon/IconSize';\nimport { useMemoizedId } from '@hooks/useMemoizedId';\nimport { useButton } from '@react-aria/button';\nimport { FocusScope, useFocusRing } from '@react-aria/focus';\nimport { useMenuTrigger } from '@react-aria/menu';\nimport { DismissButton, useOverlay } from '@react-aria/overlays';\nimport { mergeProps } from '@react-aria/utils';\nimport { useMenuTriggerState } from '@react-stately/menu';\nimport { FOCUS_STYLE } from '@utilities/focusStyle';\nimport { merge } from '@utilities/merge';\nimport { AnimatePresence, motion } from 'framer-motion';\nimport React, { ReactElement, useEffect, useRef, useState } from 'react';\nimport { AssetInputProps, AssetInputSize, AssetType } from '../AssetInput';\nimport { AssetThumbnail } from '../AssetThumbnail';\nimport { AssetSubline } from './AssetSubline';\nimport { SpinningCircle } from './SpinningCircle';\n\nexport type SelectedAssetProps = Pick<\n    AssetInputProps,\n    'actions' | 'isLoading' | 'size' | 'hideSize' | 'hideExtension'\n> & {\n    asset: AssetType;\n};\n\nexport const SelectedAsset = ({\n    asset,\n    size,\n    actions,\n    isLoading,\n    hideSize = false,\n    hideExtension = false,\n}: Required<Omit<SelectedAssetProps, 'hideSize' | 'hideExtension'>> &\n    Pick<SelectedAssetProps, 'hideSize' | 'hideExtension'>): ReactElement => {\n    const menuId = useMemoizedId();\n    const labelId = useMemoizedId();\n    const buttonRef = useRef<HTMLButtonElement | null>(null);\n    const menuState = useMenuTriggerState({ closeOnSelect: true });\n    const { isOpen, focusStrategy } = menuState;\n    const { menuTriggerProps } = useMenuTrigger({}, menuState, buttonRef);\n    const { buttonProps } = useButton(menuTriggerProps, buttonRef);\n    const { isFocusVisible, focusProps } = useFocusRing();\n    const overlayRef = useRef<HTMLDivElement | null>(null);\n    const { overlayProps } = useOverlay(\n        { onClose: () => menuState.close(), shouldCloseOnBlur: true, isOpen, isDismissable: true },\n        overlayRef,\n    );\n    const title = asset?.name || 'Your Asset';\n\n    const [flyoutWidth, setFlyoutWidth] = useState(0);\n\n    useEffect(() => {\n        let timer: number | null = null;\n        const calculateFlyoutWidth = () => {\n            const calculatedWidth = buttonRef.current?.getBoundingClientRect().width ?? 0;\n            timer = window.setTimeout(() => setFlyoutWidth(calculatedWidth), 0);\n        };\n        const resizeObserver = new ResizeObserver(calculateFlyoutWidth);\n        if (buttonRef.current) {\n            resizeObserver.observe(buttonRef.current);\n        }\n\n        return () => {\n            timer && clearTimeout(timer);\n            resizeObserver.disconnect();\n        };\n    }, []);\n\n    return (\n        <div\n            className=\"tw-font-sans tw-w-full tw-text-s tw-bg-transparent tw-font-normal tw-min-w-0\"\n            aria-labelledby={labelId}\n            title={title}\n            data-test-id=\"asset-single-input\"\n        >\n            <button\n                {...mergeProps(buttonProps, focusProps)}\n                ref={buttonRef}\n                className={merge([\n                    'tw-w-full tw-flex tw-border tw-rounded tw-overflow-hidden hover:tw-border-black-90 dark:hover:tw-border-black-40 focus-visible:tw-outline-none',\n                    isFocusVisible && FOCUS_STYLE,\n                    size === AssetInputSize.Large ? 'tw-h-[11.5rem] tw-flex-col' : 'tw-h-14',\n                    isOpen || isFocusVisible\n                        ? 'tw-border-black-90 dark:tw-border-black-10'\n                        : 'tw-border-black-20 dark:tw-border-black-80',\n                ])}\n            >\n                {isLoading && !asset && (\n                    <div\n                        className={merge([\n                            'tw-flex tw-justify-center tw-items-center',\n                            size === AssetInputSize.Large ? 'tw-w-full tw-h-32' : 'tw-w-14 tw-h-full',\n                        ])}\n                    >\n                        <SpinningCircle size={size} />\n                    </div>\n                )}\n                {asset && <AssetThumbnail asset={asset} size={size} isActive={isOpen || isFocusVisible} />}\n                <div\n                    className={merge([\n                        'tw-min-w-0 tw-max-w-full tw-flex tw-flex-auto tw-self-stretch tw-border-black-100 tw-border-opacity-25',\n                        size === AssetInputSize.Large ? 'tw-h-14 tw-border-t' : 'tw-h-full tw-border-l',\n                    ])}\n                >\n                    <div className=\"tw-min-w-0 tw-pr-3 tw-pl-4 tw-flex tw-flex-auto tw-flex-col tw-items-start tw-justify-center tw-h-full\">\n                        <span\n                            id={labelId}\n                            className={merge([\n                                'tw-max-w-full tw-text-black-100 tw-text-s tw-truncate dark:tw-text-white',\n                                (isOpen || isFocusVisible) && 'tw-font-medium',\n                            ])}\n                        >\n                            {title}\n                        </span>\n                        <AssetSubline\n                            asset={asset}\n                            isLoading={isLoading}\n                            hideSize={hideSize}\n                            hideExtension={hideExtension}\n                        />\n                    </div>\n                    <div className=\"tw-p-4 tw-flex tw-flex-none tw-items-center tw-justify-center\">\n                        <span\n                            className={merge([\n                                'tw-transition-transform',\n                                isOpen ? 'tw-rotate-180 tw-text-black-90' : 'tw-text-black-60',\n                            ])}\n                        >\n                            <IconCaretDown size={IconSize.Size16} />\n                        </span>\n                    </div>\n                </div>\n            </button>\n\n            <AnimatePresence>\n                {isOpen && (\n                    <motion.div\n                        style={{\n                            width: flyoutWidth,\n                        }}\n                        className=\"tw-absolute tw-left-auto tw-w-full tw-overflow-hidden tw-box-border tw-p-0 tw-shadow-mid tw-list-none tw-m-0 tw-mt-2 tw-z-20\"\n                        data-test-id=\"asset-single-input-flyout\"\n                        key={`asset-input-menu-${menuId}`}\n                        initial={{ height: 0 }}\n                        animate={{ height: 'auto' }}\n                        exit={{ height: 0 }}\n                        transition={{ ease: [0.04, 0.62, 0.23, 0.98], duration: 0.5 }}\n                    >\n                        <FocusScope restoreFocus>\n                            <div {...overlayProps} ref={overlayRef}>\n                                <DismissButton onDismiss={() => menuState.close()} />\n                                <ActionMenu\n                                    menuBlocks={actions}\n                                    focus={focusStrategy}\n                                    onClick={() => menuState.close()}\n                                />\n                                <DismissButton onDismiss={() => menuState.close()} />\n                            </div>\n                        </FocusScope>\n                    </motion.div>\n                )}\n            </AnimatePresence>\n        </div>\n    );\n};\nSelectedAsset.displayName = 'FondueSelectedAsset';\n"],"names":["SelectedAsset","asset","size","actions","isLoading","hideSize","hideExtension","menuId","useMemoizedId","labelId","buttonRef","useRef","menuState","useMenuTriggerState","isOpen","focusStrategy","menuTriggerProps","useMenuTrigger","buttonProps","useButton","isFocusVisible","focusProps","useFocusRing","overlayRef","overlayProps","useOverlay","title","flyoutWidth","setFlyoutWidth","useState","useEffect","timer","calculateFlyoutWidth","calculatedWidth","_a","resizeObserver","React","mergeProps","merge","FOCUS_STYLE","AssetInputSize","SpinningCircle","AssetThumbnail","AssetSubline","IconCaretDown","IconSize","AnimatePresence","motion","FocusScope","DismissButton","ActionMenu"],"mappings":"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"}